Выбор платформы и стека:

Для выбора подходящего облачного провайдера необходимо проанализировать:

1.     Поддержка и наличие необходимых сервисов(услуг)

2.     Ценообразование

 

В текущей ситуации выбирать можно из: Yandex Cloud, Selectel, VK Cloud

 

Внимательно проанализируем сервисы, рассмотренные в предыдущей работе:

1.     База данных – PostgreSQL, это хорошая и удобная в обращении БД, на которую есть куча информации в интернете. Open source-ная, есть поддержка jsonb. Для работы с потенциальными изображениями, которые могут возникать в вопросах, можно придумать следующее – хранить все изображения на основной виртуальной машине, в БД хранить путь к ним. Так мы не используем объектное хранилище, что было бы расточительно, и не перегружаем БД. Расточительно исходя из того факта, что данная услуга предоставляется как отдельная у провайдера, и это не входит в рамки бюджета тестового гранта. Поэтому, в качестве тестовых целей, мы можем использовать файловое пространство нашего сервера.

2.     VM в облаке – наше пространство, где мы будем размещать наш сервис.

Важным аспектом является то, что данный сервис не является подобием сайта алгоритмических задач leetcode.com, или hackerrank.com, который позволяет делать mock-интервью и проводить различные assesments. В обоих этих сайтах содержатся именно задачи, которые вы должны решить. Данный же бот – это открытое и поддерживаемое людьми хранилище, в котором каждый может найти для себя интересные и необычные задачи с интервью, или привнести свой вклад. В данном сервисе предлагается скорее возможность больше ознакомиться с потенциальными вопросами, темами, топиками, задачами, которые могут встретиться вам на ближайшем интервью. Приведенные выше сайты – немного про другое. Взаимодействие с ботом осуществляется по принципу «карточек». Например, вам попался вопрос во время режима интервью на позицию Go-разработчик: «Расскажите, что вам известно о systemd и cron, приведите примеры». За скрытым текстом будет спрятан авторский ответ. Вы сами отвечаете так, как считаете нужным, а затем сверяетесь с ответом. В перспективе можно также сделать систему с выборами правильного ответа, возможностью вставить ответ в поле ввода и т. д. Есть пространство для развития. Ну и конечно -- все бесплатно!

Касательно вопроса о том, почему это именно виртуальный сервер, а не функция:

2.1.         Функция — это, по сути, микросервис, который может выполнять только одно действие в ответ на событие. Используя FaaS, провайдер запускает сервер вместе с функцией, выполняет функцию, а затем выключает сервер. Serverless приложения активны только тогда, когда используется функция.

2.2.         Второй немаловажный фактор – на такие вызовы функции есть лимиты, и при большом количестве пользователей такие вызовы будут исчисляться сотнями тысяч. Это бот, а поэтому, каждая команда\слово, отправленная в Телеграм от пользователя, будет пробуждать бота и отнимать количество использований данной функции.

2.3.         По сути, такой подход не позволяет иметь какое-то поддерживаемое состояние сервера. В нашем случае это двойной минус, так как в 1-м пункте было предложено решение по хранению также изображений на нашей виртуальной машине.

2.4.         Использовать такой подход, конечно, можно, и для этого даже есть отдельный механизм через webhook-и Телеграм. Но, подводя итог выше сказанному, у нас есть ограничения, которые не позволят отслеживать состояние нашего приложения. О каком тогда сервисе анализа данных может идти речь (DataLens), если наше приложение выключено всегда?

2.5.         Касательно простоя сервера – у большинства провайдеров можно выключать машину, если она не используется. Но в таком случае мы не получаем ограничение на обращение к нашему боту, как это было бы в случае FaaS.

3.     Сервис визуализации данных – есть отличное решение от Yandex, называемое DataLens. В нем можно добавлять различные источники для анализа, начиная от тех же Postgres, Prometheus, заканчивая Google таблицами. С помощью него мы сможем анализировать популярность того или иного топика, сводку по БД, потенциальные метрики и т. д.

 Язык разработки -- Go.

Сравнение провайдеров:

В текущей ситуации 2 из приведенных выше 3-х провайдеров имеют стартовый грант. Это VK и Yandex. У первого он составляет 3000, у второго 4000. По ценообразованию Yandex выходит дешевле в среднем на 20% для оборудования, которое будет полностью удовлетворять наши нужды. Соответственно, однозначный выбор идет в сторону Yandex Cloud, так как помимо этого мы собираемся использовать его «уникальный» по своей сути сервис DataLens. Остальные сервисы: виртуальный сервер и PostgreSQL там также доступны.

Срок предоставления гранта – 60 дней, чего в целом, должно хватить для реализации задуманной идеи.

Теперь определимся с конкретными параметрами каждого из сервисов:
1. База данных -- PostgreSQL 14 версии, cpu optimized, 2 vCPU, 4 RAM, 10 GB. Данная конфигурация является минимальной и также удовлетворяет нашим потребностям и обойдется в 3744,5 р/месяц, что отлично вписывается в наш бюджет.
2. Виртуальная машина (далее в.м.)-- В Yandex Cloud в.м. идут на процессорах Intel Ice Lake/Broadwell/Cascade Lake. Самой дешевой и подходящей конфигурацией будет следующий выбор -- Inte Ice Lake, 2 vCPU 20%, 1 RAM. Также, в качестве опции, можно выбрать "прерываемая" в.м. -- это означает, что наша в.м. будет самопроизвольна выключаться, разумеется, с сохранением всех данных. После этого ее нужно будет включить повторно. Данная опция предоставляется с большой скидкой, и это означает, что включив ее на приведенную выше конфигурацию, мы получим стоимость в 252 р/месяц. Это отличная идея, чтобы протестировать наши возможности и уложиться в бюджет, но для готового решения это, разумеется, не годится.
3. DataLens -- является бесплатным сервисом, поэтому плата не взимается. 

Для в.м. не имеет смысла в большей конфигурации, так как большую часть будет перенимать на себя серверы Telegram. Объем базы данных, предлагаемый в качестве минимальной конфигурации должен также полностью покрыть необходимость в наличии картинок в вопросах.